{
  "openapi": "3.1.0",
  "info": {
    "title": "Fantasy Basketball Predictions API",
    "description": "API for fantasy basketball team analysis, predictions, and matchup forecasting",
    "version": "1.0.0"
  },
  "servers": [
    {
      "url": "https://hcheng.ngrok.app",
      "description": "Production server"
    }
  ],
  "paths": {
    "/api/v1/predictions/week-analysis": {
      "post": {
        "summary": "Get detailed week analysis with team predictions",
        "description": "Returns comprehensive week analysis including team predictions, injury statuses, and matchup details for all teams",
        "operationId": "getWeekAnalysis",
        "parameters": [
          {
            "name": "api_key",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "API authentication key"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Request body containing week analysis parameters",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "week_index": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 23,
                    "description": "Fantasy week number (1-23)"
                  },
                  "day_of_week_override": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 6,
                    "description": "Override starting day (0=Monday, 6=Sunday), default=0"
                  }
                },
                "required": ["week_index"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response with week analysis data"
          },
          "400": {
            "description": "Invalid parameters"
          }
        }
      }
    },
    "/api/v1/matchup/current-prediction": {
      "post": {
        "summary": "Get comprehensive matchup prediction with scores and player details",
        "description": "Returns detailed matchup prediction including predicted scores, remaining days in the week, players playing with game counts, and daily cumulative predictions. Accepts either date or week number as input.",
        "operationId": "getCurrentMatchupPrediction",
        "parameters": [
          {
            "name": "api_key",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "API authentication key"
          }
        ],
        "requestBody": {
          "description": "Optional request body with matchup parameters",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "week_index": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 23,
                    "description": "Fantasy week number (1-23), defaults to current week if not provided"
                  },
                  "date": {
                    "type": "string",
                    "format": "date",
                    "description": "Date in YYYY-MM-DD format (alternative to week_index). Season starts 2024-10-22."
                  },
                  "team_id": {
                    "type": "integer",
                    "description": "Team ID to get matchup for (defaults to first matchup if not provided)"
                  },
                  "day_of_week_override": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 6,
                    "description": "Starting day override (0=Monday, 6=Sunday), default=0"
                  },
                  "injury_status": {
                    "type": "array",
                    "items": {
                      "type": "string",
                      "enum": ["ACTIVE", "DAY_TO_DAY", "OUT", "QUESTIONABLE"]
                    },
                    "description": "List of injury statuses to include in predictions, default=['ACTIVE']"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response with matchup prediction data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "week_index": {
                          "type": "integer",
                          "description": "Matchup week number"
                        },
                        "date_range": {
                          "type": "object",
                          "properties": {
                            "start_date": {
                              "type": "string",
                              "format": "date",
                              "description": "First day of the matchup week"
                            },
                            "end_date": {
                              "type": "string",
                              "format": "date",
                              "description": "Last day of the matchup week"
                            },
                            "remaining_days": {
                              "type": "integer",
                              "description": "Number of days remaining in the week (0 if week is over)"
                            }
                          }
                        },
                        "matchup": {
                          "type": "object",
                          "properties": {
                            "home_team": {
                              "type": "object",
                              "properties": {
                                "id": {
                                  "type": "integer"
                                },
                                "name": {
                                  "type": "string"
                                },
                                "owner": {
                                  "type": "string"
                                },
                                "current_score": {
                                  "type": "number",
                                  "description": "Current actual score for the week"
                                },
                                "predicted_score": {
                                  "type": "object",
                                  "properties": {
                                    "mean": {
                                      "type": "number",
                                      "description": "Average predicted total score"
                                    },
                                    "std_dev": {
                                      "type": "number",
                                      "description": "Standard deviation of prediction"
                                    }
                                  }
                                },
                                "total_games": {
                                  "type": "integer",
                                  "description": "Total NBA games for this team this week"
                                },
                                "players_playing": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "name": {
                                        "type": "string"
                                      },
                                      "position": {
                                        "type": "string"
                                      },
                                      "pro_team": {
                                        "type": "string",
                                        "description": "NBA team name"
                                      },
                                      "injury_status": {
                                        "type": "string"
                                      },
                                      "games_this_week": {
                                        "type": "integer"
                                      },
                                      "game_days": {
                                        "type": "array",
                                        "items": {
                                          "type": "integer"
                                        },
                                        "description": "Array of day indices when player has games (0=Monday, 6=Sunday)"
                                      }
                                    }
                                  }
                                },
                                "remaining_days_predictions": {
                                  "type": "array",
                                  "items": {
                                    "type": "object",
                                    "properties": {
                                      "day": {
                                        "type": "integer",
                                        "description": "Day index (0=start of week)"
                                      },
                                      "mean": {
                                        "type": "number",
                                        "description": "Predicted cumulative score from this day through end of week"
                                      },
                                      "std_dev": {
                                        "type": "number"
                                      }
                                    }
                                  }
                                }
                              }
                            },
                            "away_team": {
                              "type": "object",
                              "description": "Same structure as home_team"
                            },
                            "predicted_margin": {
                              "type": "number",
                              "description": "Difference in predicted scores (positive = home team ahead)"
                            },
                            "predicted_winner": {
                              "type": "string",
                              "description": "Name of team predicted to win"
                            }
                          }
                        },
                        "injury_status_filter": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "Injury statuses included in this prediction"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameters"
          },
          "404": {
            "description": "Team or matchup not found"
          }
        }
      }
    },
    "/api/v1/scoreboard/{week_index}": {
      "post": {
        "summary": "Get current scores for all matchups in a week",
        "description": "Returns live scores and matchup details for all teams in a specific fantasy week. Uses league.box_scores() for accurate live scoring.",
        "operationId": "getScoreboard",
        "parameters": [
          {
            "name": "week_index",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 23
            },
            "description": "Fantasy week number (1-23). Week 1 starts Oct 20, 2026 (Monday). Each week = 7 days."
          },
          {
            "name": "api_key",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "API authentication key"
          }
        ],
        "requestBody": {
          "description": "Optional request body (currently no parameters required)",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {}
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response with matchup scores",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "week_index": {
                          "type": "integer"
                        },
                        "total_matchups": {
                          "type": "integer"
                        },
                        "matchups": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "home_team": {
                                "type": "object",
                                "properties": {
                                  "id": {
                                    "type": "integer"
                                  },
                                  "name": {
                                    "type": "string"
                                  },
                                  "score": {
                                    "type": "number"
                                  },
                                  "wins": {
                                    "type": "integer"
                                  },
                                  "losses": {
                                    "type": "integer"
                                  }
                                }
                              },
                              "away_team": {
                                "type": "object",
                                "properties": {
                                  "id": {
                                    "type": "integer"
                                  },
                                  "name": {
                                    "type": "string"
                                  },
                                  "score": {
                                    "type": "number"
                                  },
                                  "wins": {
                                    "type": "integer"
                                  },
                                  "losses": {
                                    "type": "integer"
                                  }
                                }
                              },
                              "point_differential": {
                                "type": "number"
                              },
                              "leader": {
                                "type": "string"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameters"
          }
        }
      }
    },
    "/api/v1/players-playing/{scoring_period}": {
      "post": {
        "summary": "Get players from a team with games on a specific scoring period",
        "description": "Returns players with and without games for a team on a given scoring period. Includes individual player projections.",
        "operationId": "getPlayersPlaying",
        "parameters": [
          {
            "name": "scoring_period",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "minimum": 1
            },
            "description": "Scoring period ID. Each period = 1 day. 1=Oct 21, 2=Oct 22, ..., 47=Dec 6, 2025"
          },
          {
            "name": "api_key",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "API authentication key"
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Request body containing team_id",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "team_id": {
                    "type": "integer",
                    "description": "Fantasy team ID (required)"
                  }
                },
                "required": ["team_id"]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response with player data",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "team": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "integer"
                            },
                            "name": {
                              "type": "string"
                            },
                            "owner": {
                              "type": "string"
                            }
                          }
                        },
                        "scoring_period": {
                          "type": "integer"
                        },
                        "nba_teams_playing": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          }
                        },
                        "players_playing": {
                          "type": "object",
                          "properties": {
                            "count": {
                              "type": "integer"
                            },
                            "players": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "player_id": {
                                    "type": "integer"
                                  },
                                  "name": {
                                    "type": "string"
                                  },
                                  "position": {
                                    "type": "string"
                                  },
                                  "nba_team": {
                                    "type": "string"
                                  },
                                  "injury_status": {
                                    "type": "string"
                                  },
                                  "projected_avg_points": {
                                    "type": "number"
                                  },
                                  "projected_variance": {
                                    "type": "number"
                                  }
                                }
                              }
                            }
                          }
                        },
                        "players_not_playing": {
                          "type": "object",
                          "properties": {
                            "count": {
                              "type": "integer"
                            },
                            "players": {
                              "type": "array"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameters"
          },
          "404": {
            "description": "Team not found"
          }
        }
      }
    },
    "/api/v1/team/{team_id}": {
      "post": {
        "summary": "Get team information and matchup details",
        "description": "Returns comprehensive team info including predictions for a specific week",
        "operationId": "getTeamInfo",
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "Fantasy team ID"
          },
          {
            "name": "api_key",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "API authentication key"
          }
        ],
        "requestBody": {
          "description": "Optional request body with prediction parameters",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "week_index": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 23,
                    "description": "Fantasy week number (1-23), defaults to current week if not provided"
                  },
                  "day_of_week_override": {
                    "type": "integer",
                    "minimum": 0,
                    "maximum": 6,
                    "description": "Override starting day (0=Monday, 6=Sunday), default=0"
                  },
                  "injury_status": {
                    "type": "string",
                    "description": "Comma-separated injury statuses (e.g., 'ACTIVE,PROBABLE'), default='ACTIVE'"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response with team and matchup data"
          },
          "404": {
            "description": "Team not found"
          }
        }
      }
    },
    "/api/v1/team/{team_id}/roster": {
      "post": {
        "summary": "Get team roster with player details",
        "description": "Returns current roster with player positions, injury status, and other details",
        "operationId": "getTeamRoster",
        "parameters": [
          {
            "name": "team_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer"
            },
            "description": "Fantasy team ID"
          },
          {
            "name": "api_key",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "API authentication key"
          }
        ],
        "requestBody": {
          "description": "Optional request body (no parameters required)",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {}
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response with roster data"
          },
          "404": {
            "description": "Team not found"
          }
        }
      }
    },
    "/api/v1/scout/free-agents": {
      "post": {
        "summary": "Scout free agents with stats, schedules, and roster context",
        "description": "AI-friendly one-stop-shop endpoint returning free agents with 7-day schedules (ISO 8601 dates), back-to-back detection, team injury context with position matching, and optional roster context. All dates in YYYY-MM-DD format for easy AI reasoning.",
        "operationId": "scoutFreeAgents",
        "parameters": [
          {
            "name": "api_key",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "API authentication key"
          }
        ],
        "requestBody": {
          "description": "Request parameters for free agent scouting",
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "team_id": {
                    "type": "integer",
                    "description": "User's team ID to include roster context with schedules (optional)"
                  },
                  "week_index": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 23,
                    "description": "Fantasy matchup week (1-23), defaults to current week"
                  },
                  "limit": {
                    "type": "integer",
                    "minimum": 1,
                    "maximum": 500,
                    "default": 20,
                    "description": "Number of top free agents to return"
                  },
                  "min_avg_points": {
                    "type": "number",
                    "minimum": 0,
                    "default": 5.0,
                    "description": "Minimum avg_last_30 points to include in results"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successful response with free agents, schedules, and roster context",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success"
                    },
                    "data": {
                      "type": "object",
                      "properties": {
                        "matchup_context": {
                          "type": "object",
                          "properties": {
                            "week_index": {
                              "type": "integer",
                              "description": "Fantasy matchup week"
                            },
                            "date_range": {
                              "type": "object",
                              "properties": {
                                "start_date": {
                                  "type": "string",
                                  "format": "date",
                                  "description": "Start date of matchup week (ISO 8601)"
                                },
                                "end_date": {
                                  "type": "string",
                                  "format": "date",
                                  "description": "End date of matchup week (ISO 8601)"
                                }
                              }
                            },
                            "days_in_period": {
                              "type": "integer",
                              "example": 7
                            }
                          }
                        },
                        "roster": {
                          "type": "object",
                          "description": "User's roster with schedules (only if team_id provided)",
                          "properties": {
                            "team_id": {
                              "type": "integer"
                            },
                            "team_name": {
                              "type": "string"
                            },
                            "total_players": {
                              "type": "integer"
                            },
                            "players": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "player_id": {
                                    "type": "integer"
                                  },
                                  "name": {
                                    "type": "string"
                                  },
                                  "nba_team": {
                                    "type": "string"
                                  },
                                  "position": {
                                    "type": "string"
                                  },
                                  "injury_status": {
                                    "type": "string",
                                    "enum": ["ACTIVE", "DAY_TO_DAY", "OUT", "QUESTIONABLE"]
                                  },
                                  "scoring": {
                                    "type": "object",
                                    "properties": {
                                      "avg_last_30": {
                                        "type": "number"
                                      },
                                      "avg_year": {
                                        "type": "number"
                                      },
                                      "avg_projected": {
                                        "type": "number"
                                      }
                                    }
                                  },
                                  "schedule_next_7_days": {
                                    "type": "array",
                                    "description": "7-day schedule with ISO 8601 dates",
                                    "items": {
                                      "type": "object",
                                      "properties": {
                                        "date": {
                                          "type": "string",
                                          "format": "date",
                                          "description": "Game date (YYYY-MM-DD)"
                                        },
                                        "has_game": {
                                          "type": "boolean"
                                        },
                                        "is_back_to_back": {
                                          "type": "boolean",
                                          "description": "True if player has game on consecutive days"
                                        }
                                      }
                                    }
                                  },
                                  "total_games_next_7": {
                                    "type": "integer",
                                    "description": "Total games in next 7 days"
                                  },
                                  "back_to_back_count": {
                                    "type": "integer",
                                    "description": "Number of back-to-back occurrences"
                                  }
                                }
                              }
                            }
                          }
                        },
                        "free_agents": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "player_id": {
                                "type": "integer"
                              },
                              "name": {
                                "type": "string"
                              },
                              "nba_team": {
                                "type": "string"
                              },
                              "injury_status": {
                                "type": "string",
                                "enum": ["ACTIVE", "DAY_TO_DAY", "OUT", "QUESTIONABLE"]
                              },
                              "injured": {
                                "type": "boolean",
                                "description": "True if player has injury status OUT"
                              },
                              "expected_return_date": {
                                "type": "string",
                                "format": "date",
                                "nullable": true,
                                "description": "Expected return date (YYYY-MM-DD) for injured players. Null if unknown or season-ending injury."
                              },
                              "days_until_return": {
                                "type": "integer",
                                "nullable": true,
                                "description": "Number of days until expected return. Null if no return date. AI can use thresholds: >30 = too long, <=14 = stash candidate, <=3 = high priority."
                              },
                              "on_waivers": {
                                "type": "boolean",
                                "description": "True if player was claimed on waivers recently"
                              },
                              "waiver_clear_date": {
                                "type": "string",
                                "format": "date",
                                "nullable": true,
                                "description": "Date (YYYY-MM-DD) when player clears waivers and becomes a free agent"
                              },
                              "positions_eligible": {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                },
                                "example": ["SG", "SF", "G", "F"]
                              },
                              "schedule_next_7_days": {
                                "type": "array",
                                "description": "7-day schedule with ISO 8601 dates and back-to-back flags",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "date": {
                                      "type": "string",
                                      "format": "date",
                                      "description": "Game date (YYYY-MM-DD)"
                                    },
                                    "has_game": {
                                      "type": "boolean"
                                    },
                                    "is_back_to_back": {
                                      "type": "boolean",
                                      "description": "True if player's team has games on consecutive days"
                                    }
                                  }
                                }
                              },
                              "total_games_next_7": {
                                "type": "integer",
                                "description": "Total games in next 7 days"
                              },
                              "back_to_back_count": {
                                "type": "integer",
                                "description": "Number of back-to-back game occurrences"
                              },
                              "scoring": {
                                "type": "object",
                                "properties": {
                                  "avg_last_30": {
                                    "type": "number"
                                  },
                                  "total_30": {
                                    "type": "number"
                                  },
                                  "gp_30": {
                                    "type": "integer"
                                  },
                                  "avg_year": {
                                    "type": "number"
                                  },
                                  "avg_projected": {
                                    "type": "number"
                                  }
                                }
                              },
                              "team_injuries": {
                                "type": "array",
                                "description": "Injured players on same NBA team with position matching",
                                "items": {
                                  "type": "object",
                                  "properties": {
                                    "player_name": {
                                      "type": "string"
                                    },
                                    "position": {
                                      "type": "string"
                                    },
                                    "positions_eligible": {
                                      "type": "array",
                                      "items": {
                                        "type": "string"
                                      },
                                      "description": "Positions injured player can play"
                                    },
                                    "injury_status": {
                                      "type": "string",
                                      "enum": ["OUT", "DAY_TO_DAY"]
                                    },
                                    "avg_points": {
                                      "type": "number"
                                    },
                                    "position_match": {
                                      "type": "boolean",
                                      "description": "True if injured player can fill same roster slot as free agent"
                                    }
                                  }
                                }
                              }
                            }
                          }
                        },
                        "summary": {
                          "type": "object",
                          "properties": {
                            "total_free_agents_analyzed": {
                              "type": "integer"
                            },
                            "returned": {
                              "type": "integer"
                            },
                            "min_avg_points_filter": {
                              "type": "number"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameters"
          }
        }
      }
    }
  },
  "components": {
    "schemas": {},
    "securitySchemes": {
      "ApiKeyAuth": {
        "type": "apiKey",
        "in": "query",
        "name": "api_key"
      }
    }
  }
}
